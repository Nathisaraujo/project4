{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load crispy_forms_tags %}

<main>
  <h1>Welcome back, {{ user.username }}!</h1>
    <!-- dropdown menu -->
    <ul class="nav nav-tabs">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Post</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="{% url 'add_post' username=user.username %}">New Post</a></li>
              <li><a class="dropdown-item" href="{% url 'user_posts' username=user.username %}">Manage Posts</a></li>
            </ul>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Profile</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="{% url 'edit_profile' username=user.username %}">Edit personal information</a></li>
            </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'liked_posts' username=user.username %}">Activity</a>
        </li>
      </ul>
    
      <!-- Welcome message -->

    <div class="container auth-style">
      <div class="row auth-container">
        <div class="col">
          {% if user_profile.picture %}
          <img src="{{ user_profile.picture.url }}" alt="Profile Picture" class="img-thumbnail">
          {% endif %}
        </div>
        <div class="col">
          <h2>Your personal details</h2>
          <p><strong>Username:</strong> {{ user.username }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
          <p>Bio: {{ user_profile.bio }}</p>
          <p>Birth Date: {{ user_profile.birth_date }}</p>
          <p>Location: {{ user_profile.location }}</p>
          <p>Last Login Date: {{ user_profile.last_login_date }}</p>
          <p>Registration Date: {{ user_profile.registration_date }}</p>
          <p>Gender: {{ user_profile.get_gender_display }}</p>

          <p>
            <a class="btn btn-sillytalks" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
              <i class="fa-solid fa-square-poll-vertical"></i>User Statistics
            </a>
          </p>
          <div class="collapse" id="collapseExample">
            <div class="card card-body">
              <table class="table table-hover table-responsive">
                <thead>
                  <tr class="table-danger">
                    <th scope="col">Interaction</th>
                    <th scope="col">Count</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">Posts you've done</th>
                    <td>{{ post_count }}</td>
                  </tr>
                  <tr>
                    <th scope="row">You commented</th>
                    <td>{{ comment_count }}</td>
                  </tr>
                  <tr>
                    <th scope="row">You voted</th>
                    <td>{{ user_total_votes }}</td>
                  </tr>
                  <tr>
                    <th scope="row">Votes in your posts</th>
                    <td>{{ total_votes }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>          
        </div>
      </div>
    </div>
</main>
{% endblock content %}